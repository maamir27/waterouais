<h1><%= @station.name %></h1>

<p>Address: <%= @station.address %></p>
<p>Rating: <%= @station.avg_rating %></p>


<% @station.photos.each do |photo| %>
  <%= cl_image_tag photo.key, height: 300, width: 400, crop: :fill %>
<% end %>


<%= link_to "Back to Browse", root_path, class: "btn btn-secondary" %>

<%= link_to "Check-in", new_station_review_path(@station.id), class: "btn btn-secondary", id: "check-in-btn" %>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var checkInBtn = document.getElementById('check-in-btn');
    checkInBtn.addEventListener('click', function(event) {
      event.preventDefault();

    fetch('/stations/<%= @station.id %>/check_in', {
      method: 'POST',
      headers: {
        'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
      }
    })
      .then(function(response) {
        if (response.ok) {
          window.location.href = '<%= new_station_review_path(@station.id) %>';
        } else {
          console.error('You cannot perform this action.');
        }
      });
      checkInBtn.disabled = true;
    });
  });
</script>
